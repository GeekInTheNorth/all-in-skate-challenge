@model AllInSkateChallenge.Features.Framework.Models.PageViewModel<AllInSkateChallenge.Features.Home.HomePageViewModel>

@{
    Layout = "_PageViewModelLayout";
}

@functions{
    string GetPositionClass(int position)
    {
        switch (position)
        {
            case 1:
                return "leaderboard-position leaderboard-position--first";
            case 2:
                return "leaderboard-position leaderboard-position--second";
            case 3:
                return "leaderboard-position leaderboard-position--third";
            default:
                return "leaderboard-position";
        }
    }
}

<div class="row">
    <div class="col-xl-12">
        <p>ALL IN challenges you to join our virtual skate along the Leeds-Liverpool canal (127.5 miles)!   The Leeds Liverpool canal is the longest canal in Britain built as a single waterway and snakes through the northern heartlands of the Industrial Revolution, including right through our very own Bradford! Skate whenever, wherever, and take however long you need.  Track your miles here and share your successes in our <a href="https://www.facebook.com/groups/3257681721008087" target="_blank">Facebook Group</a>. Disclaimer: the actual Leeds-Liverpool canal isn't skateable...  you'll need a boat!</p>
        @if (Model.Content.Summary != null && Model.Content.Summary.NumberOfSkaters > 1 && Model.Content.Summary.TotalMiles > 0)
        {
            <p>@Model.Content.Summary.NumberOfSkaters skaters have now taken up the challenge and skated a collective @Model.Content.Summary.TotalMiles.ToString("F1") miles.</p>
        }
    </div>
</div>

<div class="row">
    <div class="col-xl-12">
        @if (!Model.IsLoggedIn)
        {
            <div class="card mt-3 mb-3 border-allin-green">
                <h5 class="card-header bg-allin-green">Register for the Skate Challenge</h5>
                <div class="card-body">
                    <p class="card-text">Register now to join the ALL IN Skate Challenge and begin your virtual journey along the Leeds Liverpool Canal.</p>
                    <p class="card-text">We understand that 127.5 miles is a long distance to commit to, you can always aim for one of the other awesome milestones along the Leeds Liverpool Canal if you are looking for something a bit shorter.</p>
                    <form id="external-account" asp-area="Identity" asp-page="/Account/ExternalLogin" method="post" class="form-horizontal">
                        <a class="btn btn-primary" asp-area="Identity" asp-page="/Account/Register">Register as a new challenger</a>
                        <button type="submit" class="btn btn-strava" name="provider" value="Strava" title="Log in using your strava account"></button>
                    </form>
                </div>
            </div>
        }

        <img src="~/images/AllInSkateMapOnly.png" class="img-fluid" />
    </div>
</div>

<div class="row mt-3">
    @if (Model.Content.LeaderBoard != null && Model.Content.LeaderBoard.Any())
    {
        <div class="col-xl-6 mb-3">
            <h2>Leader Board</h2>
            <table class="table">
                <thead class="thead-dark">
                    <tr>
                        <th scope="col">#</th>
                        <th scope="col">Skater</th>
                        <th scope="col">Total Miles</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var entry in Model.Content.LeaderBoard)
                    {
                        <tr>
                            <td class="align-middle"><span class="@GetPositionClass(entry.Place)">@entry.Place</span></td>
                            <td class="align-middle">
                                <picture>
                                    <source media="(min-width:576px)" srcset="@entry.GravatarUrl?s=48">
                                    <source srcset="@entry.GravatarUrl?s=28">
                                    <img src="@entry.GravatarUrl?s=28" alt="@entry.Name Gravatar Profile Image" class="leaderboard-profile" />
                                </picture>
                                @entry.Name
                            </td>
                            <td class="align-middle">@entry.TotalMiles.ToString("F2")</td>
                        </tr>
                    }
                </tbody>
            </table>
            <a asp-controller="LeaderBoard" asp-action="Index" class="btn btn-primary">See entire leaderboard</a>
        </div>
    }

    @if (Model.Content.LatestUpdates != null && Model.Content.LatestUpdates.Any())
    {
        <div class="col-xl-6 mb-3">
            <h2>Latest Journeys</h2>
            <table class="table">
                <thead class="thead-dark">
                    <tr>
                        <th scope="col">Skater</th>
                        <th scope="col">Logged</th>
                        <th scope="col">Miles</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var entry in Model.Content.LatestUpdates)
                    {
                        <tr>
                            <td class="align-middle">
                                <picture>
                                    <source media="(min-width:576px)" srcset="@entry.GravatarUrl?s=48">
                                    <source srcset="@entry.GravatarUrl?s=28">
                                    <img src="@entry.GravatarUrl?s=28" alt="@entry.Skater Gravatar Profile Image" class="leaderboard-profile" />
                                </picture>
                                @entry.Skater
                            </td>
                            <td class="align-middle">@entry.Logged.ToString("dd/MM/yyyy")</td>
                            <td class="align-middle">@entry.Miles.ToString("F2")</td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>
    }
</div>
